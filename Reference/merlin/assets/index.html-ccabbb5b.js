import"./modulepreload-polyfill-3cfb730f.js";import{j as e,r as l}from"./localStorage-70c0cae5.js";import{a as _}from"./client-4954293f.js";import{S as d}from"./merlin-logo-4543e454.js";import{F as n,e as y,G as j,B as i}from"./browserPolyfillWrapper-bb116cae.js";import{v,w}from"./index-eedd1636.js";/* empty css             */import"./i18n-bc409d68.js";import{T as N,a as S}from"./themeContext-5e650432.js";import{u as C}from"./useTranslation-24cdda08.js";const I=["https://.*.hdblog.it/.*"];function T(){const{t:r}=C(),[c,a]=l.useState(!1),[o,x]=l.useState(null),p=S(),[h,m]=l.useState(!1);async function b(){return i.tabs.query({active:!0,currentWindow:!0}).then(s=>{const t=s[0];t?i.tabs.reload(t.id):o&&i.tabs.reload(o.id)}).finally(()=>{o&&i.action.setPopup({popup:"",tabId:o.id}).then(()=>{a(!1),window.close()})})}l.useEffect(()=>{c&&(document.documentElement.className+=" "+p.resolvedTheme)},[p.resolvedTheme,c]),l.useEffect(()=>{n.tabs.query({active:!0,currentWindow:!0}).then(s=>{const t=s[0];t&&(x(t),v().then(g=>{g?n.action.setPopup({popup:n.runtime.getURL("/popup.html"),tabId:t.id}).then(()=>{a(!0),m(!0)}):(t.url==="https://getmerlin.in/chat"&&n.action.setPopup({popup:"",tabId:t.id}).then(()=>{a(!1),window.close()}),t.url&&(t.url.startsWith("chrome://")||t.url.startsWith("chrome-extension://")||t.url.startsWith("edge://")||t.url.startsWith("extension://")||t.url.startsWith("brave://")||t.url.startsWith("arc://")||t.url.startsWith("opera://")||t.url.startsWith("vivaldi://"))?n.tabs.create({url:"https://getmerlin.in/chat"}):t.id&&n.tabs.sendMessage(t.id,{action:y.TOGGLE_CHAT_GUI,from:j.POPUP_SCRIPT,payload:{trigger:"toolbar_icon"}}).then(()=>n.action.setPopup({popup:"",tabId:t.id}).then(()=>{a(!1),window.close()})).catch(E=>{console.error("Failed to request to open CHAT_GUI for current tab"),a(!0)}))}))})},[]);function f(){return c?h?e.jsxs("div",{className:"flex h-64 w-96 flex-col justify-center gap-2 bg-background px-3 py-2 text-zinc-100",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{className:"h-8 w-8"}),e.jsx("div",{className:"text-lg font-medium",children:r("popup_index.shortcut_conflict")})]}),e.jsxs("div",{className:"text-zinc-400",children:[e.jsxs("div",{children:[r("popup_index.message")," ",e.jsx("kbd",{className:"rounded-lg border border-gray-500 bg-gray-600 px-1 py-0.5 text-xs font-semibold text-gray-100",children:r("popup_index.ctrl_m")})," ",r("popup_index.here_what_to_do")]}),e.jsxs("ul",{className:"my-2 list-inside list-disc",children:[e.jsx("li",{children:r("popup_index.goto_shortcut")}),e.jsx("li",{children:r("popup_index.switch_custom")})]}),r("popup_index.this_ensures")," ",e.jsx("kbd",{className:"rounded-lg border border-gray-500 bg-gray-600 px-1 py-0.5 text-xs font-semibold text-gray-100",children:r("popup_index.ctrl_m")})," ",r("popup_index.wont_summon")]}),e.jsx("button",{className:"cursor-pointer gap-2 rounded-md border border-cornblue-500 bg-cornblue-600 px-4 py-1.5 text-base text-zinc-50 transition-all duration-500 [border-style:solid] hover:bg-cornblue-500 dark:text-zinc-900",onClick:()=>{const s=w(),t=s==="firefox"?"about:addons":s==="edge"?"edge://extensions/shortcuts":"chrome://extensions/shortcuts";i.tabs.create({active:!0,url:t})},type:"button",children:r("popup_index.open_shortcut")})]}):I.some(s=>new RegExp(s).test((o==null?void 0:o.url)??""))?e.jsxs("div",{className:"flex h-40 w-80 flex-col justify-center gap-2 bg-background px-3 py-2 text-primary",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{className:"h-8 w-8"}),e.jsx("div",{className:"text-lg font-medium",children:r("popup_index.not_supported")})]}),e.jsx("div",{className:"text-muted-foreground",children:r("popup_index.go_to_magic")}),e.jsx("button",{className:"cursor-pointer gap-2 rounded-md border border-cornblue-500 bg-cornblue-600 px-4 py-1.5 text-base text-primary transition-all duration-500 [border-style:solid] hover:bg-cornblue-500",onClick:()=>{i.tabs.create({url:"https://getmerlin.in/chat"})},type:"button",children:r("popup_index.open_magic")})]}):e.jsxs("div",{className:"flex h-40 w-80 flex-col justify-center gap-2 bg-background px-3 py-2 text-primary",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(d,{className:"h-8 w-8"}),e.jsx("div",{className:"text-lg font-medium",children:r("popup_index.merlin_refresh")})]}),e.jsx("div",{className:"text-muted-foreground",children:r("popup_index.plz_refresh")}),e.jsx("button",{className:"cursor-pointer gap-2 rounded-md border border-cornblue-500 bg-cornblue-600 px-4 py-1.5 text-base text-primary transition-all duration-500 [border-style:solid] hover:bg-cornblue-500",onClick:b,type:"button",children:r("popup_index.refresh")})]}):null}return e.jsx("div",{className:"h-full w-full bg-background",children:f()})}const u=document.getElementById("root");u&&_(u).render(e.jsx(N,{children:e.jsx(T,{})}));
