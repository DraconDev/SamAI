import{q as h,Q as N}from"./browserPolyfillWrapper-bb116cae.js";import{m as b,n as p}from"./localStorage-70c0cae5.js";import{f as g}from"./analytics-910dabef.js";import{d as y}from"./index-eedd1636.js";const v=14,w=100,u=2e3;var d=(e=>(e.NOT_FOUND="NOT_FOUND",e.UNKNOWN="UNKNOWN",e.FOUND="FOUND",e))(d||{}),C=(e=>(e.INITIATED="INITIATED",e.SUCCESS="SUCCESS",e.UNKNOWN="UNKNOWN",e))(C||{}),U=(e=>(e.DEFAULT="default",e.LOADING="loading",e.GLIMPSE="glimpse",e.SUMMARY="summary",e.SUCCESS="SUCCESS",e.TRANSCRIPT="transcript",e.ERROR="error",e))(U||{});function k(e){const t=e;document.getElementsByTagName("video")[0].currentTime=Number(t),g({eventName:"SeekVideo",eventType:"Button",feature:"YoutubeSummaryContainer",firedFromFile:"content-migrated/youtubeSummary/YoutubeSummaryContainer"})}function O(e){var t;if(e=decodeURI(e),typeof e=="string"){const o=(t=(e==null?void 0:e.split("?"))[1])==null?void 0:t.split("&"),a={};return o&&o.length&&o.map(r=>{const s=r==null?void 0:r.split("="),i=s[0],c=s[1];a[i]=c}),a}}const l=e=>{const t=[/^https?:\/\/youtu\.be\/(.*)$/,/^https?:\/\/www\.youtube\.com\/watch\?v=(.*)$/,/^https?:\/\/www\.youtube\.com\/embed\/(.*)$/,/^https?:\/\/www\.youtube\.com\/v\/(.*)$/,/^https?:\/\/www\.youtube\.com\/live\/([^?&]*)$/];let n=null;for(const o of t){const a=e.match(o);if(a){n=a[1];break}}if(!n){const o=O(e);n=o==null?void 0:o.v}if(!n)throw new Error(`Could not parse video ID from YouTube URL: ${e}`);return n=n==null?void 0:n.split("&")[0],n},P=()=>{const e=l(document.URL),t=document.querySelector("div#title h1 yt-formatted-string"),n=document.querySelector("#above-the-fold #upload-info #channel-name #container #text-container #text a.yt-simple-endpoint"),o=t==null?void 0:t.innerText;return{channelName:n==null?void 0:n.innerText,videoId:e,videoTitle:o}},Y=()=>{const e=document.getElementsByClassName("video-ads ytp-ad-module")[0];return!!(e&&e.hasChildNodes())},x=()=>{const e=window.location.href;return l(e)},T=async(e,t,n)=>{const o=await h.fetchQuery(N.MerlinConfig);let a=o.summarizer.youtube.costPerHour??v;t===d.NOT_FOUND&&(a=o.summarizer.whisper.costPerHour??w);let r=null,s=null;if(e){const[i,c=0,f=0]=e.split(":").reverse();r=Number(i)+Number(c)*60+Number(f)*3600}return r&&(s=Math.ceil(r/3600*a)),n&&(s*=u),s??null},E=async(e,t,n)=>{let o;if(e){const[a,r=0,s=0]=e.split(":").reverse();o=s<3?t+(n?1*u:1):s<6?t+(n?2*u:2):s<9?t+(n?3*u:3):t+(n?4*u:4)}return o},I=e=>{const t=Math.floor(Number(e)/3600),n=Math.floor(Number(e)%3600/60),o=Math.floor(Number(e)%3600%60);return`${t>0?`${t}:`:""}${n<10?`0${n}`:n}:${o<10?`0${o}`:o}`},F=()=>{var o;const e=(o=document.querySelector("span.ytp-time-duration"))==null?void 0:o.textContent;let t=3e3,n;if(e){const[a,r=0,s=0]=e.split(":").reverse();n=Number(a)+Number(r)*60+Number(s)*3600,n<1800?t=3e3:n<3600?t=8e3:t=12e3}return t},m=(e,t)=>{e.click();const n=document.getElementById("contenteditable-root");y(n,t)},L=e=>{const t=`Timestamps (Powered by Merlin AI)
`+e.map(o=>`${I(o.timeStamp)} - ${o.content}`).join(`
`),n=document.getElementById("comments");if(n){n.scrollIntoView({behavior:"smooth",block:"start",inline:"nearest"});const o=document.getElementById("placeholder-area");if(o){m(o,t);return}new MutationObserver((r,s)=>{for(const i of r)if(i.addedNodes){for(const c of i.addedNodes)if(c instanceof HTMLElement&&c.id==="placeholder-area"){m(c,t),s.disconnect();return}}}).observe(n,{childList:!0,subtree:!0})}},A=()=>document.documentElement.hasAttribute("dark")?"dark":"light";function H(e,t){return`https://www.youtube.com/watch?v=${t}&t=${Math.floor(Number(e))}`}const Q=e=>e?e.trim().replace(/["]/g,"").replace(/^Title:\s*/i,""):"";function S(e){var o;if(!e||e==="AUTO")return"en";const t=p[e];return t==="Chinese Si."?"zh":t==="China Tr."?"zh-TW":((o=Object.entries(b).find(([a,r])=>r.split(";")[0].split(",")[0].split("(")[0].trim()===t))==null?void 0:o[0])??"en"}export{d as C,U,C as a,T as b,E as c,P as d,l as e,A as f,Y as g,L as h,Q as i,I as j,x as k,H as l,S as m,F as n,k as s};
