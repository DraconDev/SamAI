var P=Object.defineProperty;var $=(e,t,s)=>t in e?P(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;var r=(e,t,s)=>($(e,typeof t!="symbol"?t+"":t,s),s),V=(e,t,s)=>{if(!t.has(e))throw TypeError("Cannot "+s)};var n=(e,t,s)=>(V(e,t,"read from private field"),s?s.call(e):t.get(e)),y=(e,t,s)=>{if(t.has(e))throw TypeError("Cannot add the same private member more than once");t instanceof WeakSet?t.add(e):t.set(e,s)},b=(e,t,s,a)=>(V(e,t,"write to private field"),a?a.call(e,s):t.set(e,s),s);var L=(e,t,s)=>(V(e,t,"access private method"),s);import{r as o,a1 as H,z as C,c as J,L as R,j as G}from"./localStorage-70c0cae5.js";var B=()=>{var e,t,s;try{let a=((e=globalThis.navigator)==null?void 0:e.userAgent).match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if(a[1]==="Chrome")return parseInt(a[2])<100||((s=(t=globalThis.chrome.runtime)==null?void 0:t.getManifest())==null?void 0:s.manifest_version)===2}catch{return!1}return!1},w,m,u,E,p,M,A,N,U,W,I,z,F,Q=(F=class{constructor({area:e="sync",allCopied:t=!1,copiedKeyList:s=[],serde:a={}}={}){y(this,U);y(this,I);y(this,w,void 0);y(this,m,void 0);y(this,u,void 0);y(this,E,void 0);y(this,p,new Map);y(this,M,void 0);r(this,"isCopied",e=>this.hasWebApi&&(this.allCopied||this.copiedKeySet.has(e)));y(this,A,!1);r(this,"getExtStorageApi",()=>{var e,t;return((e=globalThis.browser)==null?void 0:e.storage)||((t=globalThis.chrome)==null?void 0:t.storage)});r(this,"isWatchSupported",()=>this.hasExtensionApi);r(this,"keyNamespace","");r(this,"isValidKey",e=>e.startsWith(this.keyNamespace));r(this,"getNamespacedKey",e=>`${this.keyNamespace}${e}`);r(this,"getUnnamespacedKey",e=>e.slice(this.keyNamespace.length));r(this,"serde",{serializer:JSON.stringify,deserializer:JSON.parse});r(this,"rawGetAll",()=>{var e;return(e=n(this,m))==null?void 0:e.get()});r(this,"getAll",async()=>{let e=await this.rawGetAll();return Object.entries(e).filter(([t])=>this.isValidKey(t)).reduce((t,[s,a])=>(t[this.getUnnamespacedKey(s)]=a,t),{})});r(this,"copy",async e=>{var i,c;let t=e===void 0;if(!t&&!this.copiedKeySet.has(e)||!this.allCopied||!this.hasExtensionApi)return!1;let s=this.allCopied?await this.rawGetAll():await n(this,m).get((t?[...this.copiedKeySet]:[e]).map(this.getNamespacedKey));if(!s)return!1;let a=!1;for(let h in s){let d=s[h],l=(i=n(this,u))==null?void 0:i.getItem(h);(c=n(this,u))==null||c.setItem(h,d),a||(a=d!==l)}return a});r(this,"rawGet",async e=>(await this.rawGetMany([e]))[e]);r(this,"rawGetMany",async e=>this.hasExtensionApi?await n(this,m).get(e):e.filter(this.isCopied).reduce((t,s)=>{var a;return t[s]=(a=n(this,u))==null?void 0:a.getItem(s),t},{}));r(this,"rawSet",async(e,t)=>await this.rawSetMany({[e]:t}));r(this,"rawSetMany",async e=>(n(this,u)&&Object.entries(e).filter(([t])=>this.isCopied(t)).forEach(([t,s])=>n(this,u).setItem(t,s)),this.hasExtensionApi&&await n(this,m).set(e),null));r(this,"clear",async(e=!1)=>{var t;e&&((t=n(this,u))==null||t.clear()),await n(this,m).clear()});r(this,"rawRemove",async e=>{await this.rawRemoveMany([e])});r(this,"rawRemoveMany",async e=>{n(this,u)&&e.filter(this.isCopied).forEach(t=>n(this,u).removeItem(t)),this.hasExtensionApi&&await n(this,m).remove(e)});r(this,"removeAll",async()=>{let e=await this.getAll(),t=Object.keys(e);await this.removeMany(t)});r(this,"watch",e=>{let t=this.isWatchSupported();return t&&n(this,N).call(this,e),t});y(this,N,e=>{var t;for(let s in e){let a=this.getNamespacedKey(s),i=((t=n(this,p).get(a))==null?void 0:t.callbackSet)||new Set;if(i.add(e[s]),i.size>1)continue;let c=(h,d)=>{if(d!==this.area||!h[a])return;let l=n(this,p).get(a);if(!l)throw new Error(`Storage comms does not exist for nsKey: ${a}`);Promise.all([this.parseValue(h[a].newValue),this.parseValue(h[a].oldValue)]).then(([g,k])=>{for(let x of l.callbackSet)x({newValue:g,oldValue:k},d)})};n(this,w).onChanged.addListener(c),n(this,p).set(a,{callbackSet:i,listener:c})}});r(this,"unwatch",e=>{let t=this.isWatchSupported();return t&&L(this,U,W).call(this,e),t});r(this,"unwatchAll",()=>L(this,I,z).call(this));this.setCopiedKeySet(s),b(this,E,e),b(this,A,t),this.serde={...this.serde,...a};try{this.hasWebApi&&(t||s.length>0)&&b(this,u,window.localStorage)}catch{}try{this.hasExtensionApi&&(b(this,w,this.getExtStorageApi()),B()?b(this,m,H(n(this,w)[this.area],{exclude:["getBytesInUse"],errorFirst:!1})):b(this,m,n(this,w)[this.area]))}catch{}}get primaryClient(){return n(this,m)}get secondaryClient(){return n(this,u)}get area(){return n(this,E)}get hasWebApi(){try{return typeof window<"u"&&!!window.localStorage}catch(e){return console.error(e),!1}}get copiedKeySet(){return n(this,M)}get allCopied(){return n(this,A)}get hasExtensionApi(){try{return!!this.getExtStorageApi()}catch(e){return console.error(e),!1}}setCopiedKeySet(e){b(this,M,new Set(e))}async getItem(e){return this.get(e)}async getItems(e){return await this.getMany(e)}async setItem(e,t){await this.set(e,t)}async setItems(e){await await this.setMany(e)}async removeItem(e){return this.remove(e)}async removeItems(e){return await this.removeMany(e)}},w=new WeakMap,m=new WeakMap,u=new WeakMap,E=new WeakMap,p=new WeakMap,M=new WeakMap,A=new WeakMap,N=new WeakMap,U=new WeakSet,W=function(e){for(let t in e){let s=this.getNamespacedKey(t),a=e[t],i=n(this,p).get(s);i&&(i.callbackSet.delete(a),i.callbackSet.size===0&&(n(this,p).delete(s),n(this,w).onChanged.removeListener(i.listener)))}},I=new WeakSet,z=function(){n(this,p).forEach(({listener:e})=>n(this,w).onChanged.removeListener(e)),n(this,p).clear()},F),q=class extends Q{constructor(){super(...arguments);r(this,"get",async t=>{let s=this.getNamespacedKey(t),a=await this.rawGet(s);return this.parseValue(a)});r(this,"getMany",async t=>{let s=t.map(this.getNamespacedKey),a=await this.rawGetMany(s),i=await Promise.all(Object.values(a).map(this.parseValue));return Object.keys(a).reduce((c,h,d)=>(c[this.getUnnamespacedKey(h)]=i[d],c),{})});r(this,"set",async(t,s)=>{let a=this.getNamespacedKey(t),i=this.serde.serializer(s);return this.rawSet(a,i)});r(this,"setMany",async t=>{let s=Object.entries(t).reduce((a,[i,c])=>(a[this.getNamespacedKey(i)]=this.serde.serializer(c),a),{});return await this.rawSetMany(s)});r(this,"remove",async t=>{let s=this.getNamespacedKey(t);return this.rawRemove(s)});r(this,"removeMany",async t=>{let s=t.map(this.getNamespacedKey);return await this.rawRemoveMany(s)});r(this,"setNamespace",t=>{this.keyNamespace=t});r(this,"parseValue",async t=>{try{if(t!==void 0)return this.serde.deserializer(t)}catch(s){console.error(s)}})}};function X(e,t){let s=typeof e=="object",a=s?e.key:e,[i,c]=o.useState(t),[h,d]=o.useState(!0),l=o.useRef(!1),g=o.useRef(t instanceof Function?t():t);o.useEffect(()=>{g.current=i},[i]);let k=o.useRef(s?e.instance:new q),x=o.useCallback(f=>k.current.set(a,f!==void 0?f:g.current),[a]),T=o.useCallback(async f=>{let S=f instanceof Function?f(g.current):f;await x(S),l.current&&c(S)},[x]);o.useEffect(()=>{l.current=!0;let f={[a]:S=>{l.current&&(c(S.newValue),d(!1))}};return k.current.watch(f),(async()=>{let S=await k.current.get(a);if(t instanceof Function){let j=t==null?void 0:t(S,!0);j!==void 0&&await T(j)}else c(S!==void 0?S:t);d(!1)})(),()=>{l.current=!1,k.current.unwatch(f),t instanceof Function&&c(t)}},[a,T]);let _=o.useCallback(()=>{k.current.remove(a),c(void 0)},[a]);return[i,T,{setRenderValue:c,setStoreValue:x,remove:_,isLoading:h}]}const O=475,K=C.object({chatGUIDimensions:C.object({height:C.number(),init:C.boolean(),width:C.number()}).default({height:600,init:!1,width:O}),floatingChat:C.enum(["native","iframe"]).default("iframe"),theme:C.enum(["system","dark","light"]).default("system")}),v=K.parse({});function Y(){const[e=v,t]=X({instance:new J({area:"local"}),key:"localUserSettings"},a=>{var c;const i={height:Math.ceil(.98*window.innerHeight),init:!0,width:O};return a?((c=a==null?void 0:a.chatGUIDimensions)!=null&&c.init||(a.chatGUIDimensions=i),{...v,...a}):{...v,chatGUIDimensions:i}});async function s(a){if(typeof a=="function"){const c=await R.get("localUserSettings");if(c){const d=a(c),l=K.parse(d);return t(l)}const h=a(v);return t(h)}const i=K.parse(a);return t(i)}return{details:e,update:s}}async function ae(){const e=await R.get("localUserSettings");return e?K.parse(e):v}function Z(e,t,s){const a=o.useCallback(l=>window.matchMedia(l),[]),i=o.useMemo(()=>e.map(a),[e,a]),c=o.useCallback(()=>{const l=i.findIndex(g=>g.matches);return(t==null?void 0:t[l])||s},[t,s,i]),[h,d]=o.useState(c);return o.useEffect(()=>{const l=()=>d(c);return i.forEach(g=>g.addEventListener("change",l)),()=>i.forEach(g=>g.removeEventListener("change",l))},[c,i]),h}const D=o.createContext(null);function ee(){const e=window.location.origin;let t="light";if(e.includes("linkedin.com")&&(document.documentElement.className.includes("theme--dark")||document.documentElement.className.includes("theme--mercado-dark"))&&(t="dark"),(e.includes("twitter.com")||e.includes("x.com"))&&(document.body.style.backgroundColor==="rgb(21, 32, 43)"||document.body.style.backgroundColor==="rgb(0, 0, 0)")&&(t="dark"),e.includes("facebook.com")&&document.documentElement.className.includes("__fb-dark-mode")&&(t="dark"),e.includes("outlook.live.com")){const s=document.documentElement.getAttribute("style");s&&s.includes("--black: #FFFFFF;")&&(t="dark")}return e.includes("google.com")&&document.head.querySelector('meta[name="color-scheme"]')!==null&&(t="dark"),e.includes("bing.com")&&document.body.className.includes("b_dark")&&(t="dark"),e.includes("duckduckgo.com")&&getComputedStyle(document.body).backgroundColor==="rgb(28, 28, 28)"&&(t="dark"),t}function ie({children:e,overrideThemeForWebsite:t}){const s=Y(),a=Z(["(prefers-color-scheme: dark)"],[!0],!1)?"dark":"light",i=t?ee():s.details.theme==="system"?a:s.details.theme,c=o.useCallback(d=>s.update({theme:d}),[]),h=o.useMemo(()=>({resolvedTheme:i,updateTheme:c}),[i]);return G.jsx(D.Provider,{value:h,children:G.jsx("div",{className:`flex-1 print:hidden ${i}`,children:e})})}function ne(){const e=o.useContext(D);if(!e)throw new Error("useThemeContext has to be used within <ThemeContext.Provider>");return e}export{O as C,X as E,ie as T,ne as a,ae as g,Y as u};
