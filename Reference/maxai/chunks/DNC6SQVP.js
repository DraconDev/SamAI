import{b as st}from"./2WYRGMZA.js";import{f as ft,m as dt,q as F}from"./PRI4DNE5.js";import{a as gt}from"./7ETG7F5K.js";import{g as nt}from"./K3RX6V6Z.js";import{b as X,c as h}from"./4L3TOTPW.js";import{c as q,i as et}from"./K5PYBOWW.js";import{c as Q}from"./KOAEEWKV.js";import{C as Y}from"./DXJBONGG.js";import{b as D,e as J}from"./Y2RTU6FS.js";import{m as R,p as tt,s as ot}from"./IE6X6P55.js";import{c as Z}from"./BJ6PO45I.js";import{la as y,na as M}from"./URK6S63I.js";import{a as rt}from"./JDSHOLU5.js";import{M as j,b as O}from"./WINLMBYH.js";import{u as K}from"./NO5PF2KS.js";import{a as V}from"./4B6UFNBQ.js";import{f as S}from"./GAV6HCJA.js";var at=S(ft()),it=S(gt()),U=S(dt());var o=S(V()),xt=({onSelectLanguage:g,languageOptions:p,currentLanguage:m,menuListBoxSx:E,sx:f})=>{let{t:T}=j(),b=20,C=(0,o.useRef)(null),d=(0,o.useRef)(null),[u,c]=(0,o.useState)(""),[i,x]=(0,o.useState)(null),I=(0,o.useRef)(!1),[A,P]=(0,o.useState)(1),[L,w]=(0,o.useState)([]),[s,k]=(0,o.useState)({suggestedLanguages:[],otherLanguages:[]});(0,o.useEffect)(()=>{(async()=>{let t=await O.getLanguages(p);k(t)})()},[p,m]);let B=s.suggestedLanguages,_=s.otherLanguages,pt=e=>{let{scrollTop:t,scrollHeight:n,clientHeight:l}=e.currentTarget;if(n-t<=l*1.5){let a=A+1,H=(a-1)*b,mt=H+b,G=_.slice(H,mt);G.length>0&&(w(ct=>[...ct,...G]),P(a))}};(0,o.useEffect)(()=>{let e=_.slice(0,b);w(e)},[_]);let{suggestedOptions:z,otherOptions:W,allOptions:v}=(0,o.useMemo)(()=>{if(u.trim()){let e=p.filter(t=>`${t.value}${t?.en_label??""}${t.label}`.toLocaleLowerCase().includes(u.trim().toLocaleLowerCase()));return{suggestedOptions:[],otherOptions:e,allOptions:e}}return{suggestedOptions:B,otherOptions:L,allOptions:[...B,...L]}},[u,p,B,L]),N=v.length-1,$=e=>{x(t=>{if(t!==null){let n=e==="increase"?t+1:t-1;return n>=N?N:n<=0?0:n}return t})};(0,o.useEffect)(()=>{d.current&&(d.current.focus(),setTimeout(()=>{d.current?.focus()},200))},[]),(0,o.useEffect)(()=>{u!==""&&x(0)},[u]),(0,o.useEffect)(()=>{if(C.current&&i!==null){let e=v[i];if(e){let t=C.current,n=t.querySelector(`[data-testid="language-item--${e.value}"]`);if(n){let l=t.getBoundingClientRect(),a=n.getBoundingClientRect();a.top>=l.top&&a.bottom<=l.bottom||(a.top<l.top?t.scrollTop+=a.top-l.top:a.bottom>l.bottom&&(t.scrollTop+=a.bottom-l.bottom))}}}},[i,v]);let ut=()=>{if(!v.length)return o.default.createElement(M,{width:"100%",justifyContent:"center",alignItems:"center",spacing:1},o.default.createElement(U.default,{sx:{fontSize:32,color:"text.secondary"}}),o.default.createElement(y,{fontSize:12,color:"text.secondary"},T("package__ui:language_selector__empty_text")));let e=(t,n)=>{let l=m===t.value;return o.default.createElement(tt,{"data-testid":`language-item--${t.value}`,selected:i===n,key:`${n}-${t.value}`,sx:[{py:"6px",px:"10px",borderRadius:1,mt:.5,"&.Mui-selected":{backgroundColor:a=>a.palette.mode==="light"?"rgba(0, 0, 0, 0.04)":"rgba(255, 255, 255, 0.08)"}}],onClick:a=>{a.stopPropagation(),O.saveUsageLanguage(t),g&&g(t)}},o.default.createElement(ot,{sx:{my:0},primary:o.default.createElement(M,{direction:"row",alignItems:"center",sx:{color:"text.primary",fontSize:14}},o.default.createElement(y,{fontSize:"inherit",noWrap:!0,sx:{color:"inherit"}},t.label),l?o.default.createElement(at.default,{sx:{fontSize:"inherit",color:"text.primary",ml:"auto"}}):null),secondary:t.en_label?o.default.createElement(y,{fontSize:12,noWrap:!0},t.en_label):null}))};return o.default.createElement(R,{sx:{p:0,width:"100%"},onKeyDown:t=>{t.key==="ArrowDown"&&(t.preventDefault(),$("increase")),t.key==="ArrowUp"&&(t.preventDefault(),$("decrease"))}},z.map((t,n)=>e(t,n)),z.length>0&&W.length>0?o.default.createElement(Q,{sx:{mt:.5,mx:.5}}):null,W.map((t,n)=>e(t,n+z.length)))};return o.default.createElement(M,{sx:f},o.default.createElement(et,{inputRef:d,size:"small",id:"filter-language",value:u,onChange:e=>c(e.target.value),onCompositionStart:()=>I.current=!0,onCompositionEnd:()=>I.current=!1,placeholder:T("package__common:search"),InputProps:{startAdornment:o.default.createElement(h,{position:"start"},o.default.createElement(U.default,null)),endAdornment:u.length>0?o.default.createElement(h,{position:"start"},o.default.createElement(q,{sx:{p:.5},onClick:()=>{c("")}},o.default.createElement(it.default,null))):null,sx:{fontSize:16}},inputProps:{autoComplete:"off"},sx:{pt:1,px:1,pb:.5,[`& .${Y.root}`]:{pr:"4px"}},onKeyUp:e=>{e.stopPropagation()},onKeyDown:e=>{e.stopPropagation();let t=e.key;if((t==="ArrowDown"||t==="ArrowUp")&&(e.preventDefault(),i===null?x(0):$(t==="ArrowDown"?"increase":"decrease")),t==="Enter"&&i!==null&&!I.current){let n=v[i];e.preventDefault(),n&&(O.saveUsageLanguage(n),g&&g(n))}}}),o.default.createElement(Z,{sx:{overflow:"auto",maxHeight:310,minHeight:310,px:1,pb:0,mb:1,overscrollBehavior:"contain",scrollbarColor:e=>e.palette.scrollbarColor,boxSizing:"border-box",display:"flex",...E},ref:C,onScroll:pt},ut()))},lt=xt;var r=S(V()),It=g=>{let{options:p=K,value:m="",onChange:E,disabled:f,sx:T,labelMaxWidth:b=64,tooltipProps:C,popoverProps:d,...u}=g,[c,i]=(0,r.useState)(!1),[x,I]=(0,r.useState)(()=>p.find(s=>s.value===m)||p[0]),[A,P]=(0,r.useState)(!1),L=(0,r.useRef)(null),w=f?!1:c;return(0,r.useLayoutEffect)(()=>{let s=p.find(k=>k.value===m);s&&s!==x&&I(s)},[m]),rt(()=>{i(!1)}),r.default.createElement(r.default.Fragment,null,r.default.createElement(nt,{title:"",open:A&&!w,disabled:f,testId:"maxai--language-selector--tooltip",...C},r.default.createElement(J,{ref:L,disableRipple:!0,disabled:f,onMouseEnter:()=>{P(!0)},onMouseLeave:()=>{P(!1)},onClick:()=>{setTimeout(()=>{i(s=>!s)},0)},className:c?"LANGUAGE_SELECTOR_AUTOCOMPLETE_OPEN":"","data-testid":"language-selector",startIcon:r.default.createElement(h,{position:"start",sx:{marginRight:0}},r.default.createElement(F,{icon:"Language",sx:{fontSize:"18px",mr:"4px",ml:"2px",color:"text.secondary"}})),endIcon:r.default.createElement(h,{position:"end",sx:{marginLeft:0,position:"absolute",right:0,top:"50%",transform:"translateY(-50%)",zIndex:1,p:"2px"}},r.default.createElement(F,{icon:"ExpandMore",sx:{color:"text.secondary",fontSize:"18px",transform:c?"rotate(180deg)":"rotate(0)"}})),sx:{minWidth:"unset",maxWidth:"120px",borderRadius:1,cursor:f?"default":"pointer","&:focus":{cursor:"default"},color:"text.secondary","&.Mui-disabled":{color:"text.secondary",opacity:1,backgroundColor:"transparent"},[`& .${D.startIcon}`]:{mr:0},[`& .${D.endIcon}`]:{ml:0,p:0},[`& .${D.endIcon} .${X.root}`]:{position:"static",transform:"none"},height:"32px",display:"flex",flexWrap:"nowrap",p:"4px 6px",alignItems:"center",justifyContent:"flex-start",fontSize:14,...T},...u},r.default.createElement(y,{noWrap:!0,fontSize:"inherit",maxWidth:b,textAlign:"left"},x.label))),r.default.createElement(st,{transitionDuration:0,disableScrollLock:!0,...d,placement:"bottom-start",fallbackPlacements:["top-start"],open:c,onClose:()=>{i(!1)},anchorEl:L.current},r.default.createElement(lt,{currentLanguage:m,languageOptions:p,onSelectLanguage:s=>{I(s),E?.(s.value),setTimeout(()=>{i(!1)},0)}})))},Wt=It;export{Wt as a};
