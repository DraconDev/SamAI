import{b as fe,j as ue,k as ge,l as _e,p as xe,q as we,s as Ee,u as be}from"./2Z5YDK5O.js";import"./PRI4DNE5.js";import"./74EYRKBC.js";import"./LIH4LVLA.js";import"./72XNZIFC.js";import"./FAXKEQHZ.js";import"./TJJA7WJ7.js";import"./BJ6OZ2RR.js";import"./LU2HGRXL.js";import"./QAN7YQ5O.js";import"./7ETG7F5K.js";import"./K3RX6V6Z.js";import"./QPKKGBHL.js";import{C as he,D as pe}from"./WOMY7LQF.js";import"./DXFQZN2P.js";import"./4L3TOTPW.js";import"./K5PYBOWW.js";import"./NVWM5Y2A.js";import"./JIAFCUZI.js";import"./APRT2ZHQ.js";import"./W4INSQR4.js";import"./KOAEEWKV.js";import"./DXJBONGG.js";import"./NW2F2GVH.js";import"./CBDTKGC6.js";import"./6IAOONHC.js";import"./XCJRDUIT.js";import"./Y2RTU6FS.js";import"./IE6X6P55.js";import"./HLAVUWHF.js";import"./F3AKZR3O.js";import{c as v}from"./BJ6PO45I.js";import"./Y6DWXSB3.js";import"./HFXK7G4X.js";import{la as me,na as M}from"./URK6S63I.js";import"./GJU7DMEZ.js";import"./PCHDBHHN.js";import"./JK5JXJMM.js";import"./PSTOF4IU.js";import"./VT4ATK36.js";import"./X7IGDKSO.js";import"./F5AXRJSB.js";import"./27G4S2R3.js";import"./JDSHOLU5.js";import"./QS33EOHT.js";import{N as V,O as k,P as O,Q as ce,R as de}from"./3M3IYJ36.js";import"./DKMNSB2V.js";import{ra as le}from"./WINLMBYH.js";import"./HKBWT4XT.js";import{sa as ae}from"./NO5PF2KS.js";import"./UB52WFCV.js";import{a as F}from"./4B6UFNBQ.js";import"./PJ57C2TE.js";import{f as I}from"./GAV6HCJA.js";var b=I(F());var j=I(F()),y;typeof window<"u"?y=window:typeof self<"u"?y=self:y=global;var ee=null,te=null,ye=20,Y=y.clearTimeout,Te=y.setTimeout,Z=y.cancelAnimationFrame||y.mozCancelAnimationFrame||y.webkitCancelAnimationFrame,Ce=y.requestAnimationFrame||y.mozRequestAnimationFrame||y.webkitRequestAnimationFrame;Z==null||Ce==null?(ee=Y,te=function(r){return Te(r,ye)}):(ee=function([r,t]){Z(r),Y(t)},te=function(r){let t=Ce(function(){Y(a),r()}),a=Te(function(){Z(t),r()},ye);return[t,a]});function qe(l){let r,t,a,c,p,_,x,w=typeof document<"u"&&document.attachEvent;if(!w){_=function(o){let i=o.__resizeTriggers__,u=i.firstElementChild,h=i.lastElementChild,f=u.firstElementChild;h.scrollLeft=h.scrollWidth,h.scrollTop=h.scrollHeight,f.style.width=u.offsetWidth+1+"px",f.style.height=u.offsetHeight+1+"px",u.scrollLeft=u.scrollWidth,u.scrollTop=u.scrollHeight},p=function(o){return o.offsetWidth!==o.__resizeLast__.width||o.offsetHeight!==o.__resizeLast__.height},x=function(o){if(o.target.className&&typeof o.target.className.indexOf=="function"&&o.target.className.indexOf("contract-trigger")<0&&o.target.className.indexOf("expand-trigger")<0)return;let i=this;_(this),this.__resizeRAF__&&ee(this.__resizeRAF__),this.__resizeRAF__=te(function(){p(i)&&(i.__resizeLast__.width=i.offsetWidth,i.__resizeLast__.height=i.offsetHeight,i.__resizeListeners__.forEach(function(f){f.call(i,o)}))})};let e=!1,s="";a="animationstart";let n="Webkit Moz O ms".split(" "),d="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),m="";{let o=document.createElement("fakeelement");if(o.style.animationName!==void 0&&(e=!0),e===!1){for(let i=0;i<n.length;i++)if(o.style[n[i]+"AnimationName"]!==void 0){m=n[i],s="-"+m.toLowerCase()+"-",a=d[i],e=!0;break}}}t="resizeanim",r="@"+s+"keyframes "+t+" { from { opacity: 0; } to { opacity: 0; } } ",c=s+"animation: 1ms "+t+"; "}let T=function(e){if(!e.getElementById("detectElementResize")){let s=(r||"")+".resize-triggers { "+(c||"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; z-index: -1; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',n=e.head||e.getElementsByTagName("head")[0],d=e.createElement("style");d.id="detectElementResize",d.type="text/css",l!=null&&d.setAttribute("nonce",l),d.styleSheet?d.styleSheet.cssText=s:d.appendChild(e.createTextNode(s)),n.appendChild(d)}};return{addResizeListener:function(e,s){if(w)e.attachEvent("onresize",s);else{if(!e.__resizeTriggers__){let n=e.ownerDocument,d=y.getComputedStyle(e);d&&d.position==="static"&&(e.style.position="relative"),T(n),e.__resizeLast__={},e.__resizeListeners__=[],(e.__resizeTriggers__=n.createElement("div")).className="resize-triggers";let m=n.createElement("div");m.className="expand-trigger",m.appendChild(n.createElement("div"));let o=n.createElement("div");o.className="contract-trigger",e.__resizeTriggers__.appendChild(m),e.__resizeTriggers__.appendChild(o),e.appendChild(e.__resizeTriggers__),_(e),e.addEventListener("scroll",x,!0),a&&(e.__resizeTriggers__.__animationListener__=function(u){u.animationName===t&&_(e)},e.__resizeTriggers__.addEventListener(a,e.__resizeTriggers__.__animationListener__))}e.__resizeListeners__.push(s)}},removeResizeListener:function(e,s){if(w)e.detachEvent("onresize",s);else if(e.__resizeListeners__.splice(e.__resizeListeners__.indexOf(s),1),!e.__resizeListeners__.length){e.removeEventListener("scroll",x,!0),e.__resizeTriggers__.__animationListener__&&(e.__resizeTriggers__.removeEventListener(a,e.__resizeTriggers__.__animationListener__),e.__resizeTriggers__.__animationListener__=null);try{e.__resizeTriggers__=!e.removeChild(e.__resizeTriggers__)}catch{}}}}}var q=class extends j.Component{constructor(...r){super(...r),this.state={height:this.props.defaultHeight||0,scaledHeight:this.props.defaultHeight||0,scaledWidth:this.props.defaultWidth||0,width:this.props.defaultWidth||0},this._autoSizer=null,this._detectElementResize=null,this._parentNode=null,this._resizeObserver=null,this._timeoutId=null,this._onResize=()=>{this._timeoutId=null;let{disableHeight:t,disableWidth:a,onResize:c}=this.props;if(this._parentNode){let p=window.getComputedStyle(this._parentNode)||{},_=parseFloat(p.paddingLeft||"0"),x=parseFloat(p.paddingRight||"0"),w=parseFloat(p.paddingTop||"0"),T=parseFloat(p.paddingBottom||"0"),C=this._parentNode.getBoundingClientRect(),z=C.height-w-T,e=C.width-_-x,s=this._parentNode.offsetHeight-w-T,n=this._parentNode.offsetWidth-_-x;(!t&&(this.state.height!==s||this.state.scaledHeight!==z)||!a&&(this.state.width!==n||this.state.scaledWidth!==e))&&(this.setState({height:s,width:n,scaledHeight:z,scaledWidth:e}),typeof c=="function"&&c({height:s,scaledHeight:z,scaledWidth:e,width:n}))}},this._setRef=t=>{this._autoSizer=t}}componentDidMount(){let{nonce:r}=this.props,t=this._autoSizer?this._autoSizer.parentNode:null;if(t!=null&&t.ownerDocument&&t.ownerDocument.defaultView&&t instanceof t.ownerDocument.defaultView.HTMLElement){this._parentNode=t;let a=t.ownerDocument.defaultView.ResizeObserver;a!=null?(this._resizeObserver=new a(()=>{this._timeoutId=setTimeout(this._onResize,0)}),this._resizeObserver.observe(t)):(this._detectElementResize=qe(r),this._detectElementResize.addResizeListener(t,this._onResize)),this._onResize()}}componentWillUnmount(){this._parentNode&&(this._detectElementResize&&this._detectElementResize.removeResizeListener(this._parentNode,this._onResize),this._timeoutId!==null&&clearTimeout(this._timeoutId),this._resizeObserver&&this._resizeObserver.disconnect())}render(){let{children:r,defaultHeight:t,defaultWidth:a,disableHeight:c=!1,disableWidth:p=!1,doNotBailOutOnEmptyChildren:_=!1,nonce:x,onResize:w,style:T={},tagName:C="div",...z}=this.props,{height:e,scaledHeight:s,scaledWidth:n,width:d}=this.state,m={overflow:"visible"},o={},i=!1;return c||(e===0&&(i=!0),m.height=0,o.height=e,o.scaledHeight=s),p||(d===0&&(i=!0),m.width=0,o.width=d,o.scaledWidth=n),_&&(i=!1),(0,j.createElement)(C,{ref:this._setRef,style:{...m,...T},...z},!i&&r(o))}};var G=I(F()),re=(0,G.createContext)({controller:de,loading:!0,headers:[],rows:[]}),H=()=>(0,G.useContext)(re);var W=I(F()),ze={display:"flex",flexDirection:"row",flexWrap:"nowrap",alignItems:"center",boxSizing:"border-box",height:V},Se={minWidth:k,maxWidth:500,width:k,px:1.5,color:"text.primary",fontSize:12,overflow:"auto",whiteSpace:"nowrap"};var je={...ze,position:"sticky",top:0,zIndex:10,"& div:first-child":{position:"sticky",left:0,zIndex:10,px:1,minWidth:O},"& div":{display:"flex",alignItems:"center",bgcolor:"background.secondary",borderRight:"1px solid",borderBottom:"1px solid",borderTop:"1px solid",borderColor:l=>l.palette.mode==="dark"?"rgba(255, 255, 255, 0.08)":"rgba(0, 0, 0, 0.04)",minWidth:k,maxWidth:500,p:0,px:1.5,height:V,color:"text.primary",fontSize:12,overflow:"auto",whiteSpace:"nowrap"},"& div:last-child":{borderRight:"none"}},Ge={...ze,"& div:first-child":{position:"sticky",left:0,zIndex:5,px:1,minWidth:O,bgcolor:"background.secondary",justifyContent:"center"},"& div":{display:"flex",alignItems:"center",borderRight:"1px solid",borderBottom:"1px solid",borderColor:l=>l.palette.mode==="dark"?"rgba(255, 255, 255, 0.08)":"rgba(0, 0, 0, 0.04)",p:0,px:1.5,height:V,color:"text.primary",fontSize:12,overflow:"auto",whiteSpace:"nowrap"},"& div:last-child":{borderRight:"none"}},Ne=l=>{let{headers:r}=l;return W.default.createElement(v,{sx:je},W.default.createElement(v,null),r.map((t,a)=>W.default.createElement(v,{key:a,sx:Se},t)))},ve=l=>{let{data:r,index:t,style:a}=l,{headers:c,rows:p}=r,_=p[t];return W.default.createElement(v,{className:`maxai-document--excel-viewer-content-row--${t}`,sx:Ge,style:a},W.default.createElement(v,{"aria-hidden":"true"},t+1),c.map((x,w)=>W.default.createElement(v,{className:`maxai-document--excel-viewer-content-col--${w}`,key:w,sx:Se},_?.[x])))};var $e=l=>{let{index:r,style:t,...a}=l;return r===0?null:b.default.createElement(ve,{index:r-1,style:{...t,width:!1},...a})},Ke=l=>{let{sheetNames:r,sheetName:t,onChangeSheetName:a,headers:c,rows:p}=l,{controller:_}=H(),x=(0,b.useMemo)(()=>{let e=n=>{let d="",m=n+1;for(;m>0;){let o=(m-1)%26;d=String.fromCharCode(65+o)+d,m=Math.floor((m-1)/26)}return d};return c.map(n=>e(n))},[c]),w=(e,s)=>{let n=e-O,d=Math.max(c.length,Math.floor(n/k)),m=s-30-V,o=Math.max(p.length,Math.floor(m/V)),i=[...c];for(;i.length<d;)i.push(i.length);let u=[...p];for(;u.length<o;){let f={};i.forEach(S=>{f[S]=""}),u.push(f)}let h=u.map((f,S)=>{if(S<p.length){let R={...f};return i.forEach(N=>{N in R||(R[N]="")}),R}return f});return{headers:i,rows:h,headerNames:i.map(f=>(R=>{let N="",L=R+1;for(;L>0;){let X=(L-1)%26;N=String.fromCharCode(65+X)+N,L=Math.floor((L-1)/26)}return N})(f))}},[T,C]=b.default.useState(0);return b.default.createElement(M,{className:"maxai-excel-viewer-content",width:"100%",height:"100%",borderRadius:"6px",overflow:"hidden"},b.default.createElement(pe,{value:T,onChange:(e,s)=>{C(s)},variant:"scrollable",scrollButtons:!1,visibleScrollbar:!0,"aria-label":"scrollable auto tabs example",TabIndicatorProps:{style:{height:"2px",transform:"scaleX(0.8)"}},sx:{minHeight:"30px"}},r?.map((e,s)=>b.default.createElement(he,{key:e,sx:{fontSize:"12px",fontWeight:400,color:"text.primary",padding:"0 14px",height:"30px",minHeight:"inherit",minWidth:"inherit","&:hover":{backgroundColor:n=>n.palette.mode==="dark"?"rgba(255, 255, 255, 0.08)":"rgba(0, 0, 0, 0.04)"}},onClick:()=>{a?.(e)},label:e}))),b.default.createElement(v,{flex:1,height:0},b.default.createElement(q,null,({height:e,width:s})=>{let n=w(s,e),d={headers:n.headers,rows:n.rows},m=b.default.forwardRef(({children:o,style:i,...u},h)=>b.default.createElement("div",{ref:h,style:{...i,width:"max-content"},...u},b.default.createElement(Ne,{headers:n.headerNames}),o));return m.displayName="ForwardedElement",b.default.createElement(Ee,{height:e,width:s,itemCount:n.rows.length+1,itemSize:V,itemData:d,innerElementType:m,ref:o=>_.setScrollList(o)},$e)})))},Le=Ke;var g=I(F());var K=I(F());var Fe=I(F());var Je=l=>{let{sx:r,...t}=l,{controller:a,fileName:c}=H(),p=le.chat_file_excel.extensions,_=c?p.some(x=>c.endsWith(x))?c:`${c}.csv`:"MaxAI.csv";return Fe.default.createElement(be,{file:a.file,fileName:_,sx:r,...t})},$=Je;var Qe=l=>{let{hideTools:r,sx:t,...a}=l,{loading:c,fileName:p}=H();return K.default.createElement(_e,{icon:K.default.createElement(fe,{documentType:"chat_file_excel"}),title:p,loading:c,sx:t,...a},!r&&K.default.createElement($,null))},Ve=Qe;var oe=I(F());var Ye=l=>{let{sx:r,...t}=l;return oe.default.createElement(xe,{sx:r,...t},oe.default.createElement($,null))},Re=Ye;var Ze=l=>{let{controller:r,file:t,fileName:a,fileSize:c,fileType:p,titleBarProps:_,toolbarProps:x,hideTitleBar:w,hideToolbar:T,onLoadStart:C,onLoadSuccess:z,onLoadError:e,sx:s}=l,[n,d]=(0,g.useState)(null),[m,o]=(0,g.useState)(),[i,u]=(0,g.useState)(""),h=(0,g.useMemo)(()=>r||new ce,[r]);(0,g.useEffect)(()=>{let E=P=>{u(P.sheetName);let D=m?.find(B=>B.name===P.sheetName);if(D){let B=setTimeout(()=>{h.setData({file:h.file,headers:D.headers||[],rows:D.rows||[]})},50);return()=>{clearTimeout(B)}}};return h.on("onChangeSheet",E),()=>{h.off("onChangeSheet",E)}},[h,m]);let f=m?.find(E=>E.name===i),{loading:S,progress:R,error:N,fileName:L,fileType:X,fileSize:J}=ue(t,{fileName:a,fileSize:c,fileType:p,onLoadStart(){C?.(h)},onLoadSuccess({file:E}){let P=null,D=!1;return import("./HDDDA5UD.js").then(({read:B,utils:Oe})=>{D||ae(E).then(Me=>{if(D)return;let U=B(Me,{type:"array",raw:!0,codepage:65001}),A=U.SheetNames.map(ie=>{let Q=Oe.sheet_to_json(U.Sheets[ie],{header:1,raw:!0,defval:null}),Xe=Math.max(...Q.map(se=>se.length)),ne=Array.from({length:Xe},(se,Ue)=>Ue);return{name:ie,headers:ne.length?ne:[0],rows:Q.length?Q:[[]]}});o(A),d(U),u(A[0]?.name||""),h.setWorkbook(U),h.setCurrentSheetName(A[0]?.name||""),h.setData({file:E,headers:A[0]?.headers||[],rows:A[0]?.rows||[]}),P=setTimeout(()=>{z?.()},100)})}).catch(B=>{e?.(new Error("Failed to load Excel parser"))}),()=>{D=!0,P&&clearTimeout(P)}},onLoadError(E){e?.(E)},onLoadReset(){h.reset()}}),De=(0,g.useMemo)(()=>({controller:h,loading:S,fileName:L,fileSize:J,fileType:X,headers:f?.headers||[],rows:f?.rows||[]}),[h,S,L,J,X,f]),{isFreeze:We,resetFreeze:Pe,disableFreeze:Be,enableFreeze:ke}=ge(),He=()=>N?g.default.createElement(me,{color:"text.primary"},"Something error, please select other File"):S||!f?.headers?.length?g.default.createElement(we,{documentType:"chat_file_excel",title:L,fileSize:J,progress:R}):g.default.createElement(Le,{sheetNames:n?.SheetNames,sheetName:f.name,onChangeSheetName:E=>{u(E),h.changeSheet(E)},headers:f.headers,rows:f.rows}),Ae=()=>T||N||S||!f?.headers?.length?null:g.default.createElement(Re,{freeze:We,disableFreeze:Be,enableFreeze:ke,...x});return g.default.createElement(re.Provider,{value:De},g.default.createElement(M,{width:"100%",height:"100%",sx:s,onMouseMove:Pe},!w&&g.default.createElement(Ve,{hideTools:!T,..._}),g.default.createElement(M,{ref:E=>h.setContainerElement(E),position:"relative",width:"100%",flex:1,height:0,px:"10px",overflow:"hidden",justifyContent:"center",alignItems:"center",boxSizing:"border-box"},He(),Ae())))},$t=g.default.memo(Ze);export{$t as default};
